<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
<title>Brick Breaker+ (Skins)</title>
<style>
  :root{
    --bg:#0b0f17; --panel:#121a27; --line:#223049;
    --text:#e7eefc; --muted:#9bb0d0;
    --shadow:0 14px 34px rgba(0,0,0,.35); --r:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; color:var(--text);
    font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR","맑은 고딕",sans-serif;
    background:
      radial-gradient(1200px 700px at 20% 0%, rgba(96,165,250,.25), transparent 60%),
      radial-gradient(900px 600px at 90% 15%, rgba(52,211,153,.18), transparent 55%),
      radial-gradient(900px 600px at 60% 100%, rgba(251,191,36,.12), transparent 55%),
      var(--bg);
    overscroll-behavior:none;
    touch-action: manipulation;
  }
  .wrap{max-width:1100px; margin:0 auto; padding:14px}
  header{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    margin:10px 0 12px;
  }
  .brand{display:flex; align-items:center; gap:10px}
  .logo{
    width:44px;height:44px;border-radius:14px;
    background:linear-gradient(145deg, rgba(96,165,250,.9), rgba(52,211,153,.85));
    display:grid;place-items:center;font-weight:900; box-shadow: var(--shadow);
  }
  h1{margin:0; font-size:18px}
  .sub{font-size:12px; color:var(--muted); margin-top:2px}

  .top{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center}
  button, select{
    border:1px solid #223049;
    background: rgba(18,26,39,.78);
    color:#e7eefc;
    padding:10px 12px; border-radius:14px;
    cursor:pointer; user-select:none;
    transition:.15s transform,.15s filter;
  }
  select{cursor:pointer}
  button:hover, select:hover{filter:brightness(1.06)}
  button:active{transform:translateY(1px) scale(.99)}
  .btn-accent{border-color: rgba(96,165,250,.55); background: linear-gradient(145deg, rgba(96,165,250,.35), rgba(18,26,39,.85))}
  .btn-good{border-color: rgba(52,211,153,.55); background: linear-gradient(145deg, rgba(52,211,153,.28), rgba(18,26,39,.85))}
  .btn-warn{border-color: rgba(251,191,36,.55); background: linear-gradient(145deg, rgba(251,191,36,.22), rgba(18,26,39,.85))}
  .grid{display:grid; grid-template-columns: 1.15fr .85fr; gap:14px}
  @media (max-width:980px){ .grid{grid-template-columns:1fr} }

  .card{
    background: linear-gradient(180deg, rgba(18,26,39,.92), rgba(15,22,34,.92));
    border:1px solid #223049;
    border-radius: var(--r);
    box-shadow: var(--shadow);
    padding:12px;
    overflow:hidden;
  }

  /* 모바일 세로 최적화 */
  .stage{display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start}
  .canvasWrap{width: min(520px, 100%)}
  canvas{
    width:100%;
    height: min(70dvh, 560px);
    max-height: 70dvh;
    background: rgba(0,0,0,.16);
    border:1px solid rgba(255,255,255,.08);
    border-radius: 16px;
    display:block;
    touch-action:none;
  }

  .side{flex:1; min-width:240px; display:flex; flex-direction:column; gap:10px}
  .panel{
    background: rgba(0,0,0,.16);
    border:1px solid rgba(255,255,255,.08);
    border-radius: 16px;
    padding:10px 12px;
  }
  .stats{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
  .stat{padding:10px 12px; border-radius:16px; background: rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.06)}
  .k{font-size:12px; color:var(--muted)}
  .v{font-size:18px; font-weight:900; margin-top:4px}
  .row2{display:flex; gap:10px; flex-wrap:wrap}
  .pill{
    font-size:12px; padding:6px 10px; border-radius:999px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.18);
    color: var(--muted);
    white-space:nowrap;
  }
  .hint{font-size:12px; color:var(--muted); line-height:1.55}
  .log{
    height: 360px; overflow:auto;
    margin-top:10px;
    white-space:pre-line;
    color: rgba(231,238,252,.88);
  }
  .pad{
    background: rgba(0,0,0,.16);
    border:1px solid rgba(255,255,255,.08);
    border-radius: 16px;
    padding:10px;
  }
  .pad b{display:block; font-size:12px; color:var(--muted); margin-bottom:8px}
  .pad .btns{display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px}
  .pad button{padding:12px 10px; font-weight:900}
  .pad .wide{grid-column: span 3}
  .toast{
    position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
    background: rgba(15,22,34,.92);
    border:1px solid rgba(255,255,255,.10);
    padding:10px 12px; border-radius:14px;
    box-shadow: var(--shadow);
    opacity:0; pointer-events:none;
    transition:.2s opacity,.2s transform;
    font-size:12px;
    max-width:min(760px, calc(100vw - 30px));
  }
  .toast.on{opacity:1; transform:translateX(-50%) translateY(-2px)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo">B</div>
      <div>
        <h1>Brick Breaker+</h1>
        <div class="sub">아이템 드랍 + 업그레이드 + 스킨/테마</div>
      </div>
    </div>

    <div class="top">
      <select id="themeSelect" title="테마 선택"></select>
      <button class="btn-accent" id="btnStart">시작</button>
      <button id="btnPause">일시정지</button>
      <button class="btn-good" id="btnNew">새 게임</button>
      <button class="btn-warn" id="btnResetBest">기록 초기화</button>
    </div>
  </header>

  <div class="grid">
    <section class="card">
      <div class="stage">
        <div class="canvasWrap">
          <canvas id="cv" width="900" height="1200" aria-label="brick breaker"></canvas>
        </div>

        <div class="side">
          <div class="panel">
            <div class="stats">
              <div class="stat"><div class="k">점수</div><div class="v" id="score">0</div></div>
              <div class="stat"><div class="k">최고</div><div class="v" id="best">0</div></div>
              <div class="stat"><div class="k">레벨</div><div class="v" id="level">1</div></div>
              <div class="stat"><div class="k">라이프</div><div class="v" id="life">3</div></div>
            </div>
            <div style="height:10px"></div>
            <div class="row2">
              <span class="pill" id="statePill">대기</span>
              <span class="pill" id="buffPill">버프: -</span>
              <span class="pill" id="speedPill">속도: -</span>
            </div>
          </div>

          <div class="panel">
            <div class="hint">
              PC: 마우스 또는 ←/→ · Space 발사/재시작 · P 일시정지<br/>
              모바일: 캔버스에서 손가락 드래그로 패들 이동 (버튼도 지원)<br/>
              아이템: 멀티볼, 확장, 슬로우, 레이저, 쉴드, +1 라이프
            </div>
          </div>

          <div class="pad">
            <b>모바일 버튼</b>
            <div class="btns">
              <button id="btnLeft">←</button>
              <button id="btnShoot">발사</button>
              <button id="btnRight">→</button>
              <button id="btnLaser">레이저</button>
              <button class="wide btn-accent" id="btnRestart">새공/재시작</button>
            </div>
          </div>

          <div class="panel">
            <div class="hint">
              • GitHub Pages: index.html 업로드 → Settings > Pages → main/root<br/>
              • 테마는 저장됨(브라우저 localStorage).
            </div>
          </div>
        </div>
      </div>
    </section>

    <aside class="card">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px">
        <div style="font-weight:900">플레이 로그</div>
        <span class="pill" id="dropsPill">드랍률</span>
      </div>
      <div class="log" id="log"></div>
    </aside>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
(() => {
  // ===== DOM =====
  const cv = document.getElementById("cv");
  const ctx = cv.getContext("2d");
  const $ = (id)=>document.getElementById(id);

  const scoreEl = $("score");
  const bestEl  = $("best");
  const levelEl = $("level");
  const lifeEl  = $("life");
  const statePill = $("statePill");
  co
